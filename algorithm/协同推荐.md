协同过滤：

## 什么是协同过滤

参考链接：https://developer.ibm.com/zh/articles/1103-zhaoct-recommstudy2/

协同过滤（Collaborative Filtering 简称CF）

* 找寻相似的用户
* 更具相似用户的喜好组织成一个排序目录

## 协同过滤的步骤

* 收集用户偏好
* 找到相似的用户或物品
* 计算推荐

### 偏好收集

通常行为类型有多种：如评分，购买，转发，不同行为之间的权重也是有差异，如购买的权重通常高于查看。通常是根据设计者的需要来添加需要的行为。常用有两种处理方式：

* 行为分组，如Amazon 购买的人还购买了，查看的人还查看了
* 行为加权，通常显示用户反馈比隐式权重大，但更加稀疏

数据处理：

* 减噪
* 归一化

### 找到相似的用户或者物品

将来用户偏好转为二维矩阵，可以将一个用户所有物品偏好作为向量来计算**用户相似度**。或者所有用户对某个物品的偏好作为向量来计算内**物品相似度**

相似度计算的几种方式：

* 欧几里得距离
* 皮尔逊相关系数
* cosine相似度
* Tanimoto系数

### 计算推荐

ITEM-CF相似邻居计算：

* 固定数量的邻居 k-neighborhoods
* 基于相似度门槛的邻居 Threshold-based neighborhoods

![image-20201028172339601](C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20201028172339601.png)

#### User CF

基于用户的 CF 的基本思想相当简单，基于用户对物品的偏好找到相邻邻居用户，然后将邻居用户喜欢的推荐给当前用户。计算上，就是将一个用户对所有物品的偏好作为一个向量来计算用户之间的相似度，找到 K 邻居后，根据邻居的相似度权重以及他们对物品的偏好，预测当前用户没有偏好的未涉及物品，计算得到一个排序的物品列表作为推荐。图 2 给出了一个例子，对于用户 A，根据用户的历史偏好，这里只计算得到一个邻居 – 用户 C，然后将用户 C 喜欢的物品 D 推荐给用户 A。

![image-20201028172454118](C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20201028172454118.png)

#### Item CF

基于物品的 CF 的原理和基于用户的 CF 类似，只是在计算邻居时采用物品本身，而不是从用户的角度，即基于用户对物品的偏好找到相似的物品，然后根据用户的历史偏好，推荐相似的物品给他。从计算的角度看，就是将所有用户对某个物品的偏好作为一个向量来计算物品之间的相似度，得到物品的相似物品后，根据用户历史的偏好预测当前用户还没有表示偏好的物品，计算得到一个排序的物品列表作为推荐。图 3 给出了一个例子，对于物品 A，根据所有用户的历史偏好，喜欢物品 A 的用户都喜欢物品 C，得出物品 A 和物品 C 比较相似，而用户 C 喜欢物品 A，那么可以推断出用户 C 可能也喜欢物品 C

![image-20201028172513523](C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20201028172513523.png)



UserCF 对比 ITEMCF

* 对于电商类产品，物品的数目远小于用户数目，Item CF性能上比User CF更优。但对于新闻，博客，等内容较多且更新频繁的应用，Item CF的性能就低了
* 使用场景：Item CF是根据相似用户喜欢的物品去做推荐，在非社交网络的网站中，如推荐一本书，同时给出的解释是某某和你有相似兴趣的人也看了这本书，这很难让用户信服，因为用户可能根本不认识那个人。
* 推荐的多样性和精度：
  * 第一种度量方法是从单个用户的角度度量，就是说给定一个用户，查看系统给出的推荐列表是否多样，也就是要比较推荐列表中的物品之间两两的相似度，不难想到，对这种度量方法，Item CF 的多样性显然不如 User CF 的好，因为 Item CF 的推荐就是和以前看的东西最相似的。
  * 第二种度量方法是考虑系统的多样性，也被称为覆盖率 (Coverage)，它是指一个推荐系统是否能够提供给所有用户丰富的选择。在这种指标下，Item CF 的多样性要远远好于 User CF, 因为 User CF 总是倾向于推荐热门的，从另一个侧面看，也就是说，Item CF 的推荐有很好的新颖性，很擅长推荐长尾里的物品。所以，尽管大多数情况，Item CF 的精度略小于 User CF， 但如果考虑多样性，Item CF 却比 User CF 好很多。
  * 如果你对推荐的多样性还心存疑惑，那么下面我们再举个实例看看 User CF 和 Item CF 的多样性到底有什么差别。首先，假设每个用户兴趣爱好都是广泛的，喜欢好几个领域的东西，不过每个用户肯定也有一个主要的领域，对这个领域会比其他领域更加关心。给定一个用户，假设他喜欢 3 个领域 A,B,C，A 是他喜欢的主要领域，这个时候我们来看 User CF 和 Item CF 倾向于做出什么推荐：如果用 User CF, 它会将 A,B,C 三个领域中比较热门的东西推荐给用户；而如果用 ItemCF，它会基本上只推荐 A 领域的东西给用户。所以我们看到因为 User CF 只推荐热门的，所以它在推荐长尾里项目方面的能力不足；而 Item CF 只推荐 A 领域给用户，这样他有限的推荐列表中就可能包含了一定数量的不热门的长尾物品，同时 Item CF 的推荐对这个用户而言，显

